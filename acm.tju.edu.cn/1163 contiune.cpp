#include <iostream>
using namespace std;
const int MAX=1000;
const int inf=0x7fff;
int map[MAX][MAX],lowcast[MAX];
bool flag[MAX];
int main()
{
    cin
